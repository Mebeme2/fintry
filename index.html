<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR Robot Mission</title>
<style>
  body { margin:0; overflow:hidden; background:transparent; }
  #startAR { position: fixed; top:50%; left:50%; transform:translate(-50%, -50%); 
             padding:20px 40px; font-size:18px; font-weight:bold; border:none; 
             border-radius:15px; background:linear-gradient(45deg,#00bcd4,#4caf50); 
             color:white; z-index:1000; cursor:pointer; }
  #missionMessage { position: fixed; top:50%; left:50%; transform:translate(-50%, -50%);
                    background:linear-gradient(135deg,#00bcd4,#4caf50); color:white; 
                    padding:30px 50px; border-radius:20px; font-size:24px; font-weight:bold;
                    text-align:center; box-shadow:0 10px 30px rgba(0,188,212,0.5);
                    opacity:0; pointer-events:none; transition:all 0.5s ease; z-index:2000; }
  #missionMessage.show { opacity:1; transform:translate(-50%, -50%) scale(1.1); }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ar.js@3.3.2/aframe/build/aframe-ar.js"></script>
</head>
<body>
<button id="startAR">Start AR Experience</button>
<div id="missionMessage">ðŸŽ‰ MISSION SUCCESS! ðŸŽ‰<br>Robot reached the bed!</div>

<a-scene embedded arjs="trackingMethod: best; sourceType: webcam;" vr-mode-ui="enabled: false" renderer="antialias: true; alpha: true;">
    <a-marker preset="hiro">
        <!-- Robot -->
        <a-entity id="robot" position="0 0 0">
            <a-box width="0.5" height="0.7" depth="0.4" color="#f8f8f8"></a-box>
            <!-- Eyes -->
            <a-box position="-0.15 0.35 0.22" width="0.08" height="0.08" depth="0.05" color="#00ffff"></a-box>
            <a-box position="0.15 0.35 0.22" width="0.08" height="0.08" depth="0.05" color="#00ffff"></a-box>
            <!-- Wheels -->
            <a-cylinder position="-0.2 0.05 0.15" radius="0.08" height="0.05" rotation="90 0 0" color="#FFFF00"></a-cylinder>
            <a-cylinder position="0.2 0.05 0.15" radius="0.08" height="0.05" rotation="90 0 0" color="#FFFF00"></a-cylinder>
            <a-cylinder position="-0.2 0.05 -0.15" radius="0.08" height="0.05" rotation="90 0 0" color="#FFFF00"></a-cylinder>
            <a-cylinder position="0.2 0.05 -0.15" radius="0.08" height="0.05" rotation="90 0 0" color="#FFFF00"></a-cylinder>
        </a-entity>

        <!-- Bed -->
        <a-box id="bed" position="1 0 0" width="0.7" height="0.4" depth="1.5" color="#8B4513"></a-box>
    </a-marker>
    <a-entity camera></a-entity>
</a-scene>

<script>
const startBtn = document.getElementById('startAR');
const robot = document.getElementById('robot');
const bed = document.getElementById('bed');
const missionMsg = document.getElementById('missionMessage');
let moving = false;

// Start AR
startBtn.addEventListener('click', () => {
    startBtn.style.display = 'none';
});

// Click bed -> move robot
bed.addEventListener('click', () => {
    if (moving) return;
    moving = true;
    const startPos = robot.object3D.position.clone();
    const endPos = bed.object3D.position.clone();
    endPos.x -= 0.6; // stop near bed
    endPos.y = startPos.y;

    let startTime = null;
    function animate(time) {
        if (!startTime) startTime = time;
        const progress = Math.min((time - startTime)/1500, 1);
        robot.object3D.position.lerpVectors(startPos, endPos, progress);
        if(progress < 1) requestAnimationFrame(animate);
        else {
            robot.object3D.position.copy(endPos);
            missionMsg.classList.add('show');
            setTimeout(()=>{ missionMsg.classList.remove('show'); moving=false; }, 2000);
        }
    }
    requestAnimationFrame(animate);
});
</script>
</body>
</html>
